<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.23">
<meta name="author" content="Version v3.3.1">
<title>Bashmatic® — BASH-based DSL helpers for humans, sysadmins, and fun.</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<link href="https://fonts.googleapis.com/css2?family=Source+Sans+Pro:wght@400;600;700&family=Source+Code+Pro:wght@400;600&display=swap" rel="stylesheet">
<style>
/*! Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment the following line when using as a custom stylesheet */
/* @import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700"; */
html{font-family:sans-serif;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
b,strong{font-weight:bold}
abbr{font-size:.9em}
abbr[title]{cursor:help;border-bottom:1px dotted #dddddf;text-decoration:none}
dfn{font-style:italic}
hr{height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type=checkbox],input[type=radio]{padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,::before,::after{box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Source Sans Pro", "Noto Serif","DejaVu Serif",serif;line-height:1;position:relative;cursor:auto;-moz-tab-size:4;-o-tab-size:4;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:600;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:500;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Fantasque Sans Mono", "Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:600;color:rgba(0,0,0,.9)}
ul,ol,dl{line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ul.square{list-style-type:square}
ul.circle ul:not([class]),ul.disc ul:not([class]),ul.square ul:not([class]){list-style:inherit}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:1px solid #dedede;word-wrap:normal}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Fantasque Sans Mono", "Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;border-radius:3px;box-shadow:0 1px 0 rgba(0,0,0,.2),inset 0 0 0 .1em #fff;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin:0 auto;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child{border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:flex;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border:1px solid #e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:hsla(0,0%,100%,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details{margin-left:1.25rem}
details>summary{cursor:pointer;display:block;position:relative;line-height:1.6;margin-bottom:.625rem;outline:none;-webkit-tap-highlight-color:transparent}
details>summary::-webkit-details-marker{display:none}
details>summary::before{content:"";border:solid transparent;border-left:solid;border-width:.3em 0 .3em .5em;position:absolute;top:.5em;left:-1.25rem;transform:translateX(15%)}
details[open]>summary::before{border:solid transparent;border-top:solid;border-width:.5em .3em 0;transform:translateY(15%)}
details>summary::after{content:"";width:1.25rem;height:1em;position:absolute;top:.3em;left:-1.25rem}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class=paragraph]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border:1px solid #e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;border-radius:4px}
.sidebarblock{border:1px solid #dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;border-radius:4px}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:first-child,.sidebarblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child,.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class=highlight],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos,pre.pygments .linenos{border-right:1px solid;opacity:.35;padding-right:.5em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}
pre.pygments span.linenos{display:inline-block;margin-right:.75em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans-serif;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;font-size:.85rem;text-align:left;margin-right:0}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all>*>tr,table.stripes-odd>*>tr:nth-of-type(odd),table.stripes-even>*>tr:nth-of-type(even),table.stripes-hover>*>tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
li>p:empty:only-child::before{content:"";display:inline-block}
ul.checklist>li>p:first-child{margin-left:-1em}
ul.checklist>li>p:first-child>.fa-square-o:first-child,ul.checklist>li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist>li>p:first-child>input[type=checkbox]:first-child{margin-right:.25em}
ul.inline{display:flex;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
td.hdlist2{word-wrap:anywhere}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:4px solid #fff;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active,#footnotes .footnote a:first-of-type:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt,summary{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,td.hdlist1,span.alt,summary{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]{border-bottom:1px dotted}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media amzn-kf8,print{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<style>
pre.rouge table td { padding: 5px; }
pre.rouge table pre { margin: 0; }
pre.rouge, pre.rouge .w {
  color: #f8f8f2;
  background-color: #272822;
}
pre.rouge .err {
  color: #272822;
  background-color: #f92672;
}
pre.rouge .c, pre.rouge .ch, pre.rouge .cd, pre.rouge .cm, pre.rouge .cpf, pre.rouge .c1, pre.rouge .cs {
  color: #75715e;
}
pre.rouge .cp {
  color: #f4bf75;
}
pre.rouge .nt {
  color: #f4bf75;
}
pre.rouge .o, pre.rouge .ow {
  color: #f8f8f2;
}
pre.rouge .p, pre.rouge .pi {
  color: #f8f8f2;
}
pre.rouge .gi {
  color: #a6e22e;
}
pre.rouge .gd {
  color: #f92672;
}
pre.rouge .gh {
  color: #66d9ef;
  background-color: #272822;
  font-weight: bold;
}
pre.rouge .k, pre.rouge .kn, pre.rouge .kp, pre.rouge .kr, pre.rouge .kv {
  color: #ae81ff;
}
pre.rouge .kc {
  color: #fd971f;
}
pre.rouge .kt {
  color: #fd971f;
}
pre.rouge .kd {
  color: #fd971f;
}
pre.rouge .s, pre.rouge .sb, pre.rouge .sc, pre.rouge .dl, pre.rouge .sd, pre.rouge .s2, pre.rouge .sh, pre.rouge .sx, pre.rouge .s1 {
  color: #a6e22e;
}
pre.rouge .sa {
  color: #ae81ff;
}
pre.rouge .sr {
  color: #a1efe4;
}
pre.rouge .si {
  color: #cc6633;
}
pre.rouge .se {
  color: #cc6633;
}
pre.rouge .nn {
  color: #f4bf75;
}
pre.rouge .nc {
  color: #f4bf75;
}
pre.rouge .no {
  color: #f4bf75;
}
pre.rouge .na {
  color: #66d9ef;
}
pre.rouge .m, pre.rouge .mb, pre.rouge .mf, pre.rouge .mh, pre.rouge .mi, pre.rouge .il, pre.rouge .mo, pre.rouge .mx {
  color: #a6e22e;
}
pre.rouge .ss {
  color: #a6e22e;
}
</style>
</head>
<body class="article">
<div id="header">
<h1>Bashmatic® — BASH-based DSL helpers for humans, sysadmins, and fun.</h1>
<div class="details">
<span id="author" class="author">Version v3.3.1</span><br>
</div>
<div id="toc" class="toc">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_ci_matrix">1. CI Matrix</a></li>
<li><a href="#_introduction">2. Introduction</a></li>
<li><a href="#_please_donate">3. Please Donate</a></li>
<li><a href="#_programming_style_modern_bash_dsl">4. Programming Style: Modern BASH + DSL</a></li>
<li><a href="#_compatibility">5. Compatibility</a></li>
<li><a href="#_project_motivation">6. Project Motivation</a></li>
<li><a href="#_installing_bashmatic">7. Installing Bashmatic</a>
<ul class="sectlevel2">
<li><a href="#_1_automated_install">7.1. 1. Automated Install</a></li>
<li><a href="#_2_automated_install_more_explicit">7.2. 2. Automated Install, More Explicit</a>
<ul class="sectlevel3">
<li><a href="#_installing_a_particular_version_or_a_branch">7.2.1. Installing a Particular Version or a Branch</a></li>
<li><a href="#_customizing_the_installer_script">7.2.2. Customizing the Installer Script</a></li>
</ul>
</li>
<li><a href="#_understanding_what_the_installer_does">7.3. Understanding what the Installer Does</a>
<ul class="sectlevel3">
<li><a href="#_to_load_bashmatic_at_login_or_not">7.3.1. To load Bashmatic at Login, or Not?</a>
<ul class="sectlevel4">
<li><a href="#_if_you_load_bashmatic_on_login_the_default_installer_mode">If you load Bashmatic on login (the default installer mode):</a></li>
<li><a href="#_if_you_do_not_want_to_load_bashnmatic_on_login">If you do not want to load Bashnmatic on login</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_when_curl_is_not_available">7.4. When <code>curl</code> is not available</a>
<ul class="sectlevel3">
<li><a href="#_discovering_available_functions">7.4.1. Discovering Available Functions</a></li>
</ul>
</li>
<li><a href="#_manual_installation">7.5. Manual Installation</a></li>
<li><a href="#_using_git">7.6. Using Git</a></li>
<li><a href="#_using_curl">7.7. Using Curl</a></li>
<li><a href="#_reloading_bashmatic">7.8. Reloading Bashmatic</a></li>
<li><a href="#_loading_bashmatic_at_startup">7.9. Loading Bashmatic at Startup</a></li>
</ul>
</li>
<li><a href="#_discovering_via_the_makefile">8. Discovering via the <code>Makefile</code></a>
<ul class="sectlevel2">
<li><a href="#_befriending_the_makefile">8.1. Befriending the Makefile</a></li>
<li><a href="#_docker_make_targets">8.2. Docker Make Targets</a></li>
</ul>
</li>
<li><a href="#_examples_of_bashmatic_in_action">9. Examples of Bashmatic in Action</a>
<ul class="sectlevel2">
<li><a href="#_example_i_install_gems_via_homebrew">9.1. Example I. Install Gems via Homebrew</a></li>
<li><a href="#_example_ii_download_and_install_binaries">9.2. Example II: Download and install binaries.</a></li>
<li><a href="#_example_iii_developer_environment_bootstrap_script">9.3. Example III: Developer Environment Bootstrap Script</a></li>
<li><a href="#_example_iv_installing_grc_colourify_tool">9.4. Example IV: Installing GRC Colourify Tool</a></li>
<li><a href="#_example_v_db_shortcut_for_database_utilities_db_top">9.5. Example V: <code>db</code> Shortcut for Database Utilities &amp; <code>db top</code></a></li>
<li><a href="#_other_db_functions">9.6. Other <code>db</code> Functions</a></li>
<li><a href="#_sub_commands_of_db">9.7. Sub-Commands of <code>db</code></a>
<ul class="sectlevel3">
<li><a href="#_sub_command_db_connections">9.7.1. Sub-Command <code>db connections</code></a></li>
<li><a href="#_sub_command_db_pga_eg_pg_activity">9.7.2. Sub-Command <code>db pga</code> (eg. <code>pg_activity</code>)</a></li>
<li><a href="#_other_sub_commands">9.7.3. Other Sub-Commands</a></li>
</ul>
</li>
<li><a href="#_bintablet_script">9.8. <code>bin/tablet</code> Script</a></li>
</ul>
</li>
<li><a href="#_usage">10. Usage</a>
<ul class="sectlevel2">
<li><a href="#_function_naming_convention_unpacked">10.1. Function Naming Convention Unpacked</a></li>
<li><a href="#_seeing_all_functions">10.2. Seeing All Functions</a></li>
<li><a href="#_seeing_specific_functions">10.3. Seeing Specific Functions</a></li>
<li><a href="#_various_modules">10.4. Various Modules</a></li>
<li><a href="#_key_modules_explained">10.5. Key Modules Explained</a>
<ul class="sectlevel3">
<li><a href="#_runtime_framework_executing_commands_the_right_way">10.5.1. Runtime Framework — Executing Commands The Right Way™</a>
<ul class="sectlevel4">
<li><a href="#_examples_of_runtime_framework">Examples of Runtime Framework</a></li>
</ul>
</li>
<li><a href="#_controlling_output">10.5.2. Controlling Output</a>
<ul class="sectlevel4">
<li><a href="#_output_components">Output Components</a></li>
<li><a href="#_output_helpers">Output Helpers</a></li>
</ul>
</li>
<li><a href="#_package_management_brew_and_rubygems">10.5.3. Package management: Brew and RubyGems</a></li>
<li><a href="#_shortening_urls_and_github_access">10.5.4. Shortening URLs and Github Access</a></li>
<li><a href="#_github_access">10.5.5. Github Access</a></li>
<li><a href="#_file_helpers">10.5.6. File Helpers</a></li>
<li><a href="#_array_helpers">10.5.7. Array Helpers</a></li>
<li><a href="#_utilities">10.5.8. Utilities</a></li>
<li><a href="#_ruby_and_ruby_gems">10.5.9. Ruby and Ruby Gems</a>
<ul class="sectlevel4">
<li><a href="#_gem_helpers">Gem Helpers</a></li>
</ul>
</li>
<li><a href="#_audio_video_compression_helpers">10.5.10. Audio &amp; Video Compression Helpers</a></li>
<li><a href="#_additional_helpers">10.5.11. Additional Helpers</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_how_to_guide">11. How To Guide</a>
<ul class="sectlevel2">
<li><a href="#_write_new_dsl_in_the_bashmatic_style">11.1. Write new DSL in the <em>Bashmatic®</em> Style</a></li>
<li><a href="#_how_can_i_test_if_the_function_was_ran_as_part_of_a_script_or_sourced_in">11.2. How can I test if the function was ran as part of a script, or "sourced-in"?</a></li>
<li><a href="#_how_can_i_change_the_underscan_or_overscan_for_an_old_monitor">11.3. How can I change the underscan or overscan for an old monitor?</a></li>
</ul>
</li>
<li><a href="#_contributing">12. Contributing</a>
<ul class="sectlevel2">
<li><a href="#_running_unit_tests">12.1. Running Unit Tests</a>
<ul class="sectlevel3">
<li><a href="#_run_tests_using_the_provided_binspecs_script">12.1.1. Run Tests Using the Provided <code>bin/specs</code> script</a></li>
<li><a href="#_running_specs_sequentially_with_binspec_p">12.1.2. Running Specs Sequentially with <code>bin/spec -P</code></a></li>
<li><a href="#_run_tests_parallel_using_the_makefile">12.1.3. Run Tests Parallel using the <code>Makefile</code></a></li>
<li><a href="#_run_tests_sequentially_using_the_makefile">12.1.4. Run Tests Sequentially using the <code>Makefile</code></a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_copyright_license">13. Copyright &amp; License</a></li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="_ci_matrix">1. CI Matrix</h2>
<div class="sectionbody">
<table class="tableblock frame-ends grid-all" style="width: 80%;">
<caption class="title">Table 1. CI Matrix</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-right valign-middle"></th>
<th class="tableblock halign-left valign-middle">Badges</th>
<th class="tableblock halign-center valign-middle">FOSSA Scanning</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-right valign-middle"><p class="tableblock"><strong>FOSSSA</strong></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code><span class="image"><a class="image" href="https://app.fossa.com/projects/git%2Bgithub.com%2Fkigster%2Fbashmatic?ref=badge_shield"><img src="https://app.fossa.com/api/projects/git%2Bgithub.com%2Fkigster%2Fbashmatic.svg?type=shield" alt="License Status"></a></span></code></p></td>
<td class="tableblock halign-left valign-bottom" rowspan="7"><p class="tableblock"><strong><span class="image"><a class="image" href="https://app.fossa.com/projects/git%2Bgithub.com%2Fkigster%2Fbashmatic?ref=badge_large"><img src="https://app.fossa.com/api/projects/git%2Bgithub.com%2Fkigster%2Fbashmatic.svg?type=large" alt="FOSSA License Scan"></a></span></strong></p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-middle"><p class="tableblock"><strong>CI Tests</strong></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code><span class="image"><a class="image" href="https://github.com/kigster/bashmatic/actions/workflows/tests.yml"><img src="https://github.com/kigster/bashmatic/actions/workflows/tests.yml/badge.svg" alt="Test"></a></span></code></p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-middle"><p class="tableblock"><strong>CI Install</strong></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code><span class="image"><a class="image" href="https://github.com/kigster/bashmatic/actions/workflows/install.yml"><img src="https://github.com/kigster/bashmatic/actions/workflows/install.yml/badge.svg" alt="Install"></a></span></code></p></td>
</tr>
<tr>
<td class="tableblock halign-right valign-middle"><p class="tableblock"><strong>ShellCheck</strong></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code><span class="image"><a class="image" href="https://github.com/kigster/bashmatic/actions/workflows/lint.yml"><img src="https://github.com/kigster/bashmatic/actions/workflows/lint.yml/badge.svg" alt="Lint"></a></span></code></p></td>
</tr>
</tbody>
<tfoot>
<tr>
<td class="tableblock halign-right valign-middle"><p class="tableblock"><strong>Gitter</strong></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code><span class="image"><a class="image" href="https://gitter.im/kigster/bashmatic?utm_source=badge&amp;utm_medium=badge&amp;utm_campaign=pr-badge&amp;utm_content=badge"><img src="https://badges.gitter.im/kigster/bashmatic.svg" alt="bashmatic"></a></span></code></p></td>
</tr>
</tfoot>
</table>
</div>
</div>
<div class="sect1">
<h2 id="_introduction">2. Introduction</h2>
<div class="sectionbody">
<div class="paragraph">
<p><em>Bashmatic®</em> is a BASH framework, meaning it&#8217;s a collection of BASH functions (almost 900 of them) that, we hope, make BASH programming <strong>easier, more enjoyable, and more importantly, fun</strong> - due to the library&#8217;s focus on providing the developer with a constant feedback about what is happening, while a script that uses Bashmatic&#8217;s helpers is running.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_please_donate">3. Please Donate</h2>
<div class="sectionbody">
<div class="paragraph">
<p><a href="https://liberapay.com/kigster/donate"><span class="image"><img src="https://liberapay.com/assets/widgets/donate.svg" alt="Donate using Liberapay" height="30"></span></a>   <a href="https://liberapay.com/kigster/donate"><span class="image"><img src="https://img.shields.io/liberapay/goal/kigster.svg?logo=liberapay" alt="https://img.shields.io/liberapay/goal/kigster" height="30"></span></a></p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>We suggest that you learn about Bashmatic from the <strong><a href="https://github.com/kigster/bashmatic/blob/main/README.pdf">PDF version of this document</a></strong> which is much better for print.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>We recently began providing function documentation using a fork of <code>shdoc</code> utility. You can find the auto-generated documentation in the <a href="https://github.com/kigster/bashmatic/blob/main/doc/USAGE.md">USAGE</a> file, or its <a href="https://github.com/kigster/bashmatic/blob/main/doc/USAGE.pdf">PDF</a> version.</p>
</li>
<li>
<p>There is also an auto-generated file listing the source of every function and module. You can find it <a href="https://github.com/kigster/bashmatic/blob/main/doc/FUNCTIONS.adoc">FUNCTIONS</a>.</p>
</li>
<li>
<p>Additionally please checkout the <a href="https://github.com/kigster/bashmatic/blob/main/doc/CHANGELOG.md">CHANGELOG</a> and the <a href="https://github.com/kigster/bashmatic/blob/main/doc/LICENSE.adoc">LICENSE</a>.</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p>After you install the library (the default location is <code>~/.bashmatic</code>), realize that you have a choice of either:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Automatically <strong>sourcing the library (and all 900+ functions) from your shell 'dotfiles'</strong> like <code>~/.bash_profile</code> by adding this line: <code>source ~/.bashmatic/init.sh</code>. On a recent M1 Apple laptop this adds about 100ms total.</p>
</li>
<li>
<p>OR, can <strong>skip it during your login initialization</strong>, and only load it at the top of the scripts that use the library.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
Both approaches are absolutely valid and have their pros and cons. Loading bashmatic in your dotfiles could be a bit risky. One way or another we&#8217;ll soon provide ways to verify that bashmatic you download is the safe and correct version, every time.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>All we&#8217;ll say on this matter is that we manage the optimize the hell out of the sourcing the library. Here is an example:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="doc/img/bashmatic-init.png" alt="Init" width="85%">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_programming_style_modern_bash_dsl">4. Programming Style: Modern BASH + DSL</h2>
<div class="sectionbody">
<div class="paragraph">
<p><em>Bashmatic®</em>'s programming style is heavily influenced by Ruby&#8217;s DSL languages. If you take a quick look at the <a href="https://github.com/kigster/bashmatic/blob/main/lib/is.sh">is.sh</a> script, it defines a bunch of DSL functions that can be chained with <code>&amp;&amp;</code>  and <code>||</code> to create a compact and self-documenting code like this:</p>
</div>
<div class="paragraph">
<p><span class="icon"><i class="fa fa-arrow-circle-down fa-3x"></i></span></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash"><span class="c"># An example of a DSL-like function</span>
<span class="k">function </span>bashmatic.auto-update<span class="o">()</span> <span class="o">{</span>
  <span class="nb">local dir</span><span class="o">=</span><span class="s2">"</span><span class="k">${</span><span class="nv">1</span><span class="k">:-</span><span class="s2">"</span><span class="k">${</span><span class="nv">BASHMATIC_HOME</span><span class="s2">"}}"</span><span class="p">
  is.a-directory </span><span class="s2">"</span><span class="k">${</span><span class="nv">dir</span><span class="k">}</span><span class="s2">"</span><span class="p"> &amp;&amp; {
    file.exists-and-newer-than </span><span class="s2">"</span><span class="k">${</span><span class="nv">dir</span><span class="k">}</span><span class="s2">/.last-update"</span><span class="p"> 30 &amp;&amp; return 0
    (
      cd </span><span class="k">${</span><span class="nv">BASHMATIC_HOME</span><span class="k">}</span><span class="p"> &amp;&amp; \
      git.is-it-time-to-update &amp;&amp; \
      git.sync-remote
    )
  </span><span class="k">}</span><span class="s2">
}

# check if the function is defined and call it
is.a-function.invoke bashmatic.auto-update "</span><span class="nv">$@</span><span class="s2">"</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>To use it in your own scripts, you&#8217;ll want to first study the Examples provided below, and take advantage of ach module available under <code>lib</code>.</p>
</div>
<div class="paragraph">
<p>Final note, - once Bashmatic is installed and loaded by your shell init files, you can type <code>is.&lt;tab&gt;&lt;tab&gt;</code> to see what functions are available to you that start with <code>is</code>. Each module under <code>lib</code> typically defines public functions starting with the name of the file. Such as, functions in <code>array.sh</code> typically start with <code>array.&lt;something&gt;.&lt;action&gt;</code></p>
</div>
<div class="paragraph">
<p><em>Bashmatic®</em> offers a huge range of ever-growing helper functions for running commands, auto-retrying, repeatable, runtime-measuring execution framework with the key function <code>run</code>. There are helpers for every occasion, from drawing boxes, lines, headers, to showing progress bars, getting user input, installing packages, and much more.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
A good portion of the helpers within <strong><em>Bashmatic®</em> are written for OS-X, although many useful functions will also work under linux.</strong>  Our entire  test suite runs on Ubuntu. There is an effort underway to convert Homebrew-specific functions to OS-neutral helpers such as <code>package.install</code> that would work equally well on linux.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Start exploring <em>Bashmatic®</em> below with our examples section. When you are ready, the complete entire set of pubic functions (nearly 500 of those) can be found in the <a href="https://github.com/kigster/bashmatic/blob/main/doc/FUNCTIONS.adoc">functions index page</a>.</p>
</div>
<div class="paragraph">
<p>And, finally, don&#8217;t worry, <strong><em>Bashmatic®</em></strong> is totally open source and free to use and extend. We just like the way it looks with a little <strong>®</strong> :)</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_compatibility">5. Compatibility</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>BASH version 4+</p>
</li>
<li>
<p>BASH version 3 (partial compatibility, some functions are disabled)</p>
</li>
<li>
<p>ZSH – as of recent update, Bashmatic is almost 90% compatible with ZSH.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Not Currently Supported</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>FISH (although you could use Bashmatic via the <code>bin/bashmatic</code> script helper or its executables)</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_project_motivation">6. Project Motivation</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This project was born out of a simple realization made by several very senior and highly experienced engineers, that:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>It is often easier to use BASH for writing things like universal <strong>installers</strong>, a.k.a. <strong>setup scripts</strong>, <strong>uploaders</strong>, wrappers for all sorts of functionality, such as <strong>NPM</strong>, <strong>rbenv</strong>, installing gems, rubies, using AWS, deploying code, etc.</p>
</li>
<li>
<p>BASH function&#8217;s return values lend themselves nicely to a compact DSL (<a href="https://en.wikipedia.org/wiki/Domain-specific_language">domain specific language</a>) where multiple functions can be chained by logical AND <code>&amp;&amp;</code> and OR <code>||</code> to provide a very compact execution logic. Most importantly, we think that this logic is <strong>extremely easy to read and understand.</strong></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Despite the above points, it is also generally accepted that:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A lot of BASH scripts are very poorly written and hard to read and understand.</p>
</li>
<li>
<p>It&#8217;s often difficult to understand what the hell is going on while the script is running, because either its not outputting anything useful, OR it&#8217;s outputting way too much.</p>
</li>
<li>
<p>When BASH errors occur, shit generally hits the fan and someone decides that they should rewrite the 20-line BASH script in C&#43;&#43; or Go, because, well, it&#8217;s a goddamn BASH script and it ain&#8217;t working.</p>
</li>
</ul>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<em>Bashmatic</em>'s goal is to make BASH programming both fun, consistent, and provide plenty of visible output to the user so that there is no mystery as to what is going on.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_installing_bashmatic">7. Installing Bashmatic</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Perhaps the easiest way to install <em>Bashmatic®</em> is using <code>curl</code> as shown below.</p>
</div>
<div class="paragraph">
<p>First, make sure that you have Curl installed, run <code>which curl</code> to see. Then copy/paste this command into your Terminal.</p>
</div>
<div class="sect2">
<h3 id="_1_automated_install">7.1. 1. Automated Install</h3>
<div class="paragraph">
<p><span class="icon"><i class="fa fa-arrow-down fa-3x"></i></span></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash">bash <span class="nt">-c</span> <span class="s2">"</span><span class="si">$(</span>curl <span class="nt">-fsSL</span> https://bashmatic.re1.re<span class="si">)</span><span class="s2">; bashmatic-install -q"</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><span class="icon"><i class="fa fa-arrow-up fa-3x"></i></span></p>
</div>
<div class="paragraph">
<p>Where:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>-q stands for "quiet";</p>
</li>
<li>
<p>-v for "verbose"</p>
</li>
</ul>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
The URL <em><a href="https://bashmatic.re1.re" class="bare">https://bashmatic.re1.re</a></em> redirects to the HEAD of the <a href="https://raw.githubusercontent.com/kigster/bashmatic/main/bin/bashmatic-install"><code>bin/bashmatic-install</code></a> script in the Github Bashmatic Repo. We use this URL so that we retain the ability to redirect the installation to a different script in the future, if need be.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_2_automated_install_more_explicit">7.2. 2. Automated Install, More Explicit</h3>
<div class="paragraph">
<p>If you prefer to be able to examine the script before executing code piped straight off the Internet, I don&#8217;t blame you. You are cautious and smart.</p>
</div>
<div class="paragraph">
<p>For folks like you, here is a slightly more secure way of doing the same thing:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash"><span class="nb">export </span><span class="nv">script</span><span class="o">=</span><span class="s2">"/tmp/install"</span>
curl <span class="nt">-fsSL</span> https://bashmatic.re1.re <span class="o">&gt;</span> /tmp/install
<span class="nb">chmod </span>755  /tmp/install

<span class="c"># At this point you can examine /tmp/install</span>
/tmp/install <span class="nt">--help</span>
/tmp/install <span class="nt">--verbose</span> <span class="nt">--debug</span> <span class="c"># install with extra info</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This method allows you to examine the <code>/tmp/install</code> script before running it.</p>
</div>
<div class="paragraph">
<p>Below are some of the explanations</p>
</div>
<div class="sect3">
<h4 id="_installing_a_particular_version_or_a_branch">7.2.1. Installing a Particular Version or a Branch</h4>
<div class="paragraph">
<p>You can install a branch or a tag of Bashmatic by passing <code>-b / --git-branch &lt;tag|branch&gt;</code> flag.</p>
</div>
</div>
<div class="sect3">
<h4 id="_customizing_the_installer_script">7.2.2. Customizing the Installer Script</h4>
<div class="paragraph">
<p>You can pass flags to the <code>bashmatic-install</code> function to control how, where to Bashmatic is installed, and where from it is downloaded, including:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>-v</code> or <code>--verbose</code> for displaying additional output, or the opposite:</p>
</li>
<li>
<p><code>-d</code> or <code>--debug</code> will print additional debugging output</p>
</li>
<li>
<p><code>-f</code> or <code>--force</code> will replace any existing bashmatic folder with the new one</p>
</li>
<li>
<p><code>-q</code> or <code>--quiet</code> for no output</p>
</li>
<li>
<p><code>-l</code> or <code>--skip-on-login</code> to NOT install the hook that loads Bashmatic on login.</p>
</li>
<li>
<p>If you prefer to install Bashmatic in a non-standard location (the default is <code>~/.bashmatic</code>),  you can use the <code>-H PATH</code> flag</p>
</li>
</ul>
</div>
<div class="exampleblock">
<div class="title">Example 1. Example of a customized installation</div>
<div class="content">
<div class="paragraph">
<p>For instance, here we are installing Bashmatic into a non-default destination, while printing additional verbose &amp; debug information, as well as using <code>-f</code> (force) to possibly overwrite the destination folder (if it already exists) with a checkout of Bashmatic according to a tag <code>v2.4.1</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash">bash <span class="nt">-c</span> <span class="s2">"</span><span class="si">$(</span>curl <span class="nt">-fsSL</span> https://bashmatic.re1.re<span class="si">)</span><span class="s2">; </span><span class="se">\</span><span class="s2">
    bashmatic-install -d -v -f -b v2.4.1 -H ~/workspace/bashmatic"</span></code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>If you have your SSH keys installed both locally, and the public key was configured with your account on Github, you might want to install Bashmatic using <code>git@github.com:kigster/bashmatic</code> origin, instead of the default <code><a href="https://github.com/kigster/bashmatic" class="bare">https://github.com/kigster/bashmatic</a></code>:</p>
</div>
<div class="paragraph">
<p>Here is the complete list of options accepted by the installer:</p>
</div>
<div class="imageblock text-left">
<div class="content">
<img src="doc/img/bashmatic-install.png" alt="Installer" width="99%">
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_understanding_what_the_installer_does">7.3. Understanding what the Installer Does</h3>
<div class="paragraph">
<p>When you run <code>bash -c "$(curl -fsSL <a href="https://bashmatic.re1.re" class="bare">https://bashmatic.re1.re</a>); bashmatic-install"</code>, the following typically happens:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>curl</code> downloads the <code>bin/bashmatic-install</code> script and passes it to the built-in BASH for evaluation.</p>
</li>
<li>
<p>Once evaluated, function <code>bashmatic-install</code> is invoked, which actually performs the installation.</p>
<div class="ulist">
<ul>
<li>
<p>This is the function that accepts the above listed arguments.</p>
</li>
</ul>
</div>
</li>
<li>
<p>The script may ask for your password to enable sudo access - this may be required on OS-X to install XCode Developer tools (which include <code>git</code>)</p>
</li>
<li>
<p>If your version of BASH is 3 or older, the script will download and build from sources version 5+ of BASH,  and install it into <code>/usr/local/bin/bash</code>. SUDO may be required for this step.</p>
</li>
<li>
<p>On OS-X the script will install Homebrew on OS-X, if not already there.</p>
<div class="ulist">
<ul>
<li>
<p>Once Brew is installed, brew packages <code>coreutils</code> and <code>gnu-sed</code> are installed, as both are required and are relied upon by Bashmatic.</p>
</li>
</ul>
</div>
</li>
<li>
<p>The script will then attempt to <code>git clone</code> the bashmatic repo into the Bashmatic home folder, or - if it already exists - it will <code>git pull</code> latest changes.</p>
</li>
<li>
<p>Finally, unless you specify <code>-l</code> or <code>--skip-on-login</code> the script will check your bash dot files, and will add the hook to load Bashmatic from either <code>~/.bashrc</code> or <code>~/.bash_profile</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The last part my require some explanation.</p>
</div>
<div class="sect3">
<h4 id="_to_load_bashmatic_at_login_or_not">7.3.1. To load Bashmatic at Login, or Not?</h4>
<div class="paragraph">
<p>Now, you may or may not want to load Bashmatic on login.</p>
</div>
<div class="sect4">
<h5 id="_if_you_load_bashmatic_on_login_the_default_installer_mode">If you load Bashmatic on login (the default installer mode):</h5>
<div class="paragraph">
<p>In other words, you have something like this in your <code>~/.bashrc</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash"><span class="c"># Let's see if ~/.bashrc mentions Bashmatic:</span>
<span class="nv">$ </span><span class="nb">grep </span>bashmatic ~/.bashrc
<span class="o">[[</span> <span class="nt">-f</span> ~/.bashmatic/init.sh <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="nb">source</span> ~/.bashmatic/init.sh</code></pre>
</div>
</div>
<div class="exampleblock">
<div class="content">
<div class="dlist">
<dl>
<dt class="hdlist1"><span class="icon"><i class="fa fa-check-circle fa-fw"></i></span> Pros of loading at login</dt>
<dd>
<p>Instant access to 800+ convenience functions Bashmatic© offers and helpers. Bashmatic will auto-update whenever its loaded from the main branch.</p>
</dd>
<dt class="hdlist1"><span class="icon"><i class="fa fa-times-circle fa-fw"></i></span> Cons of loading at login</dt>
<dd>
<p>About <em>134ms</em> delay at login, and a potential security attack vector (eg, if someone hacks the repo).</p>
</dd>
</dl>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
We recently dramatically improved the loading time of the entirety of Bashmatic© functions. Previously it took nearly 900ms, almost a full second to load 854 functions. Today it&#8217;s no more than 180ms:
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash">❯ <span class="nb">time source </span>init.sh

real  0m0.134s
user  0m0.078s
sys	  0m0.074s</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>If the above command shows the output you see above, when you grep your <code>bashrc</code> or <code>zshrc</code>, then all Bashmatic Functions will be loaded into your shell. This could be very convenient, for instance,</p>
</div>
<div class="ulist">
<ul>
<li>
<p>you could invoke <code>ruby.install-ruby-with-readline-and-openssl 3.0.1</code> to get Ruby installed.</p>
</li>
<li>
<p>You could invoke <code>gem.remote.version sym</code> to see that the last published verison of <code>sym</code> is <code>3.0.1</code>.</p>
</li>
<li>
<p>You could join an array of values with with <code>array.join ", " apple pear orange</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>NOTICE: Bashmatic takes no more than 200-300ms to load typically. That said, you might not want to have this many shell functions in your environment, so in that case you can skip login hook by passing <code>-l</code> or <code>--skip-on-login</code>.</p>
</div>
</div>
<div class="sect4">
<h5 id="_if_you_do_not_want_to_load_bashnmatic_on_login">If you do not want to load Bashnmatic on login</h5>
<div class="paragraph">
<p>Install it with:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash">bash <span class="nt">-c</span> <span class="s2">"</span><span class="si">$(</span>curl <span class="nt">-fsSL</span> https://bashmatic.re1.re<span class="si">)</span><span class="s2">; bashmatic-install -l"</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>In this case we suggest that you simply add the Bashmatic&#8217;s <code>bin</code> folder to the <code>$PATH</code>.</p>
</div>
<div class="paragraph">
<p>For instance:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash"><span class="c"># ~/.bashrc</span>
<span class="nb">export </span><span class="nv">BASHMATIC_HOME</span><span class="o">=</span><span class="s2">"</span><span class="k">${</span><span class="nv">HOME</span><span class="k">}</span><span class="s2">/.bashmatic"</span>
<span class="nb">export </span><span class="nv">PATH</span><span class="o">=</span><span class="s2">"</span><span class="k">${</span><span class="nv">BASHMATIC_HOME</span><span class="k">}</span><span class="s2">/bin:</span><span class="k">${</span><span class="nv">PATH</span><span class="k">}</span><span class="s2">"</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Then you will have access to the executable script <code>bashmatic</code> which can be used <strong>*as a "gateway" to all bashmatic functions:</strong></p>
</div>
<div class="paragraph">
<p>You use it like so: <code>bashmatic &lt;function&gt; &lt;args&gt;</code>:</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
Examples below assume you&#8217;ve set the <code>PATH</code> to include <code>${HOME}/.bashmatic/bin</code>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash"><span class="c"># Eg, if as in the previous example you sourced in Bashmatic:</span>
<span class="nv">$ </span>bashmatic.version
2.1.2

<span class="c"># If you have not, you can still invoke 'bashmatic.version':</span>
<span class="nv">$ </span>bashmatic version

<span class="c"># Or another function, 'array.join' — if you sourced in init.sh:</span>
<span class="nv">$ </span>array.join <span class="s1">'|'</span> hello goodbye
hello|goodbye

<span class="c"># Or using the script:</span>
<span class="nv">$ </span>bashmatic array.join <span class="s1">'|'</span> hello goodbye
hello|goodbye</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you get an error, perhaps <em>Bashmatic®</em> did not properly install.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_when_curl_is_not_available">7.4. When <code>curl</code> is not available</h3>
<div class="paragraph">
<p>Therefore for situawtion where <code>curl</code> may not be available, offer the following shell function that works on Linux/Ubuntu and OS-X-based systems. It can be easily extended with new operating systems:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash"><span class="c"># @description Installs bashmatic dependency into the ~/.bashmatic folder.</span>
<span class="k">function </span>install_bashmatic<span class="o">()</span> <span class="o">{</span>
  <span class="c"># install bashmatic using https:// URL instead of git@</span>
  <span class="nb">command</span> <span class="nt">-v</span> curl <span class="o">&gt;</span>/dev/null <span class="o">||</span> <span class="o">{</span>
    <span class="nb">local </span><span class="nv">OS</span><span class="o">=</span><span class="si">$(</span><span class="nb">uname</span> <span class="nt">-s</span><span class="si">)</span>
    <span class="nb">local </span>code
    <span class="k">case</span> <span class="k">${</span><span class="nv">OS</span><span class="k">}</span> <span class="k">in
    </span>Linux<span class="p">)</span>
      apt-get update <span class="nt">-yq</span> <span class="o">&amp;&amp;</span> apt-get <span class="nb">install </span>curl <span class="nt">-yqq</span>
      <span class="nv">code</span><span class="o">=</span><span class="nv">$?</span>
      <span class="o">((</span>code<span class="o">))</span> <span class="o">&amp;&amp;</span> <span class="nb">sudo </span>apt-get update <span class="nt">-yq</span> <span class="o">&amp;&amp;</span> <span class="nb">sudo </span>apt-get <span class="nb">install </span>curl <span class="nt">-yqq</span>
      <span class="p">;;</span>
    Darwin<span class="p">)</span>
      <span class="nb">command</span> <span class="nt">-v</span> brew <span class="o">&gt;</span>/dev/null <span class="o">||</span> /bin/bash <span class="nt">-c</span> <span class="s2">"</span><span class="si">$(</span>curl <span class="nt">-fsSL</span> https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh<span class="si">)</span><span class="s2">"</span>
      <span class="nb">hash</span> <span class="nt">-r</span>
      brew <span class="nb">install </span>curl
      <span class="p">;;</span>
    <span class="k">*</span><span class="p">)</span>
      <span class="nb">echo</span> <span class="s2">"OS </span><span class="k">${</span><span class="nv">OS</span><span class="k">}</span><span class="s2"> is not supported."</span>
      <span class="p">;;</span>
    <span class="k">esac</span>
  <span class="o">}</span>
  <span class="o">[[</span> <span class="nt">-d</span> ~/.bashmatic <span class="o">]]</span> <span class="o">||</span> bash <span class="nt">-c</span> <span class="s2">"</span><span class="si">$(</span>curl <span class="nt">-fsSL</span> https://bashmatic.re1.re<span class="si">)</span><span class="s2">; bashmatic-install -q -m https"</span>
  <span class="k">return </span>0
<span class="o">}</span></code></pre>
</div>
</div>
<div class="sect3">
<h4 id="_discovering_available_functions">7.4.1. Discovering Available Functions</h4>
<div class="paragraph">
<p>To discover the breadth of available functions, type the following command to see all imported shell functions:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash"><span class="c"># List all functions using 4-column mode; print top 5 lines.</span>
❯ bashmatic functions 4 | <span class="nb">head</span> <span class="nt">-5</span>
7z.a         db.psql.connect.db-set hl.yellow-on-gray  run.inspect-variables
7z.install   db.psql.connect.db-set hr                 run.inspect-variables-
7z.unzip     db.psql.connect.just-d hr.colored         run.inspect.set-skip-f
7z.x         db.psql.connect.table- http.servers       run.on-error.ask-is-en
7z.zip       db.psql.connect.table- https.servers      run.print-command

<span class="c"># or, to get the count of all functions, use 1 column output:</span>
<span class="nv">$ </span>bashmatic functions 1 | <span class="nb">wc</span> <span class="nt">-l</span>
773</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_manual_installation">7.5. Manual Installation</h3>
<div class="paragraph">
<p>To install Bashmatic manually, follow these steps (feel free to change <code>BASHMATIC_HOME</code> if you like):</p>
</div>
</div>
<div class="sect2">
<h3 id="_using_git">7.6. Using Git</h3>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash"><span class="nb">export </span><span class="nv">BASHMATIC_HOME</span><span class="o">=</span><span class="s2">"</span><span class="k">${</span><span class="nv">HOME</span><span class="k">}</span><span class="s2">/.bashmatic"</span>
<span class="nb">test</span> <span class="nt">-d</span> <span class="s2">"</span><span class="k">${</span><span class="nv">BASHMATIC_HOME</span><span class="k">}</span><span class="s2">"</span> <span class="o">||</span> <span class="se">\</span>
  git clone https://github.com/kigster/bashmatic.git <span class="s2">"</span><span class="k">${</span><span class="nv">BASHMATIC_HOME</span><span class="k">}</span><span class="s2">"</span>
<span class="nb">cd</span> <span class="s2">"</span><span class="k">${</span><span class="nv">BASHMATIC_HOME</span><span class="k">}</span><span class="s2">"</span> <span class="o">&amp;&amp;</span> ./bin/bashmatic-install <span class="nt">-v</span>
<span class="nb">cd</span> -&gt;/dev/null</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_using_curl">7.7. Using Curl</h3>
<div class="paragraph">
<p>Sometimes you may not be able to use <code>git</code> (I have seen issues ranging from local certificate mismatch to old versions of git, and more), but maybe able to download with <code>curl</code>. In that case, you can lookup the <a href="https://github.com/kigster/bashmatic/tags">latest tag</a> (substitute "v1.6.0" below with that tag), and then issue this command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash"><span class="nb">export </span><span class="nv">BASHMATIC_TAG</span><span class="o">=</span><span class="s2">"v2.4.1"</span>
<span class="nb">set</span> <span class="nt">-e</span>
<span class="nb">cd</span> <span class="k">${</span><span class="nv">HOME</span><span class="k">}</span>
curl <span class="nt">--insecure</span> <span class="nt">-fSsl</span> <span class="se">\</span>
  https://codeload.github.com/kigster/bashmatic/tar.gz/<span class="k">${</span><span class="nv">BASHMATIC_TAG</span><span class="k">}</span> <span class="se">\</span>
  <span class="nt">-o</span> bashmatic.tar.gz
<span class="nb">rm</span> <span class="nt">-rf</span> .bashmatic <span class="o">&amp;&amp;</span> <span class="nb">tar </span>xvzf bashmatic.tar.gz <span class="o">&amp;&amp;</span> <span class="nb">mv </span>bashmatic-<span class="k">${</span><span class="nv">BASHMATIC_TAG</span><span class="k">}</span> .bashmatic
<span class="nb">source</span> ~/.bashmatic/init.sh
<span class="nb">cd</span> <span class="k">${</span><span class="nv">HOME</span><span class="k">}</span>/.bashmatic <span class="o">&amp;&amp;</span> ./bin/bashmatic-install <span class="nt">-v</span>
<span class="nb">cd</span> ~ <span class="o">&gt;</span>/dev/null</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_reloading_bashmatic">7.8. Reloading Bashmatic</h3>
<div class="paragraph">
<p>You can always reload <em>Bashmatic®</em> with <code>bashmatic.reload</code> function. This simply performs the sourcing of <code>${BASHMATIC_HOME}/init.sh</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_loading_bashmatic_at_startup">7.9. Loading Bashmatic at Startup</h3>
<div class="paragraph">
<p>When you install Bashmatic it automatically adds a hook to your <code>~/.bash_profile</code>, but if you are on ZSH you may need to add it manually (for now).</p>
</div>
<div class="paragraph">
<p>Add the following to your <code>~/.zshrc</code> file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="zsh"><span class="o">[[</span> <span class="nt">-f</span> ~/.bashmatic/init.sh <span class="o">]]</span> <span class="o">&amp;&amp;</span> <span class="nb">source</span> <span class="s2">"~/.bashmatic/init.sh"</span></code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The entire library takes less than 300ms to load on ZSH and a recent MacBook Pro.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_discovering_via_the_makefile">8. Discovering via the <code>Makefile</code></h2>
<div class="sectionbody">
<div class="paragraph">
<p>The top-level <code>Makefile</code> is mostly provided as a convenience as it encapsulates some common tasks used in development by Bashmatic Author(s), as well as others useful to anyone exploring Bashmatic.</p>
</div>
<div class="paragraph">
<p>You can run <code>make help</code> and read the available targets:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash">❯ make

<span class="nb">help               </span>Prints <span class="nb">help </span>message auto-generated from the comments.
open-readme        Open README.pdf <span class="k">in </span>the system viewer

docker-build       Builds the Docker image with the tooling inside
docker-run-bash    Drops you into a BASH session with Bashmatic Loaded
docker-run-fish    Drops you into a FISH session with Bashmatic Loaded
docker-run-zsh     Drops you into a ZSH session with Bashmatic Loaded
docker-run         Drops you into a BASH session

file-stats-git     Print all  files  known to <span class="sb">`</span>git ls-files<span class="sb">`</span> <span class="nb">command
</span>file-stats-local   Print all non-test files and run <span class="sb">`</span>file<span class="sb">`</span> utility on them.

install-dev        Installs the Development Tooling using dev-setup script
install-ruby       Installs the Bashmatic default Ruby version using rbenv
<span class="nb">install            install </span>BashMatic Locally <span class="k">in</span> ~/.bashmatic

release            Make a new release named after the latest tag
tag                Tag this commit with .version and push to remote

setup              Run the comprehensive development setup on this machine
shell-files        Lists every single checked <span class="k">in </span>SHELL file <span class="k">in </span>this repo

<span class="nb">test               </span>Run fully automated <span class="nb">test </span>suite based on Bats
test-parallel      Run the fully auto-g mated <span class="nb">test </span>suite

update-changelog   Auto-generate the doc/CHANGELOG <span class="o">(</span>requires GITHUB_TOKEN <span class="nb">env </span>var <span class="nb">set</span><span class="o">)</span>
update-functions   Auto-generate doc/FUNCTIONS index at doc/FUNCTIONS.adoc/pdf
update-readme      Re-generate the PDF version of the README
update-usage       Auto-generate doc/USAGE documentation from lib shell files,
                   to doc/USAGE.adoc/pdf

update             Runs all update targets to regenerate all PDF docs and the
                   Changelog.</code></pre>
</div>
</div>
<div class="paragraph">
<p>I&#8217;ve added whitespaces around a set of common tasks you might find useful.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s take a quick look at what&#8217;s available here.</p>
</div>
<div class="sect2">
<h3 id="_befriending_the_makefile">8.1. Befriending the Makefile</h3>
<div class="paragraph">
<p>Makefile is provided as a convenience for running most common tasks and to simplify running some more complex tasks that require remembering many arguments, such as <code>make setup</code>. You might want to use the Makefile for several reasons:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><code>make open-readme</code></p>
<div class="paragraph">
<p>This tasks opens the PDF version of the README in your PDF system viewer.</p>
</div>
</li>
<li>
<p><code>make install</code></p>
<div class="paragraph">
<p>This allows you to install the Bashmatic Framework locally. It simply runs <code>bin/bashmatic-install</code> script. At most this will add hooks to your shell init files so that Bashmatic is loaded at login.</p>
</div>
</li>
<li>
<p><code>make setup</code></p>
<div class="paragraph">
<p>This task invokes the <code>bin/dev-setup</code> script under the hood, so that you can setup your local computer developer setup for software development.</p>
</div>
<div class="paragraph">
<p>Now, this script offers a very rich CLI interface, so you can either run the script directly and have a fine-grained control over what it&#8217;s doing, or you can run it with default flags via this make  target.</p>
</div>
<div class="paragraph">
<p>This particular make target runs <code>bin/dev-setup</code> script with the following actions:</p>
</div>
<div class="paragraph">
<p><code>dev, cpp, fonts, gnu, go, java, js, load-balancing, postgres, ruby</code></p>
</div>
</li>
<li>
<p><code>make test</code> and <code>make test-parallel</code>  are both meant for Bashmatic Developers and contributors. Please see the <a href="https://github.com/kigster/bashmatic#contributing">Contributing</a> section on how to run and what to expect from the UNIT tests.</p>
</li>
<li>
<p><code>make update</code> is the task that should be run by library contributors after they&#8217;ve made their their changes and want the auto-generated  documentation to reflect the  new functions added and so on and so force.  This tasks also generates the function index, re-generate the latest PDFs of <code>README</code>, <code>USAGE</code> or the <code>CHANGELOG</code> files.</p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Running <code>make update</code> is is required for submitting any pull request.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_docker_make_targets">8.2. Docker Make Targets</h3>
<div class="paragraph">
<p>Bashmatic comes with a Dockerfile that can be used to run tests or just manually validate various functionality under Linux, and possibly to experiment.</p>
</div>
<div class="paragraph">
<p>Run <code>make docker-build</code> to create an docker image <code>bashmatic:latest</code>.</p>
</div>
<div class="paragraph">
<p>Run <code>make docker-run-bash</code> (or <code>&#8230;&#8203;-zsh</code> or <code>&#8230;&#8203;-fish</code>) to start a container with your favorite shell, and then validate if your functions work as expected.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="doc/img/docker-bash.png" alt="Docker Build" width="100%">
</div>
</div>
<div class="paragraph">
<p>Note how this dropped me straight into the Linux environment prompt with Bashmatic already installed.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_examples_of_bashmatic_in_action">9. Examples of Bashmatic in Action</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>Why do we need another BASH framework?</strong></p>
</div>
<div class="paragraph">
<p>BASH is know to be too verbose and unreliable. We beg to differ. This is why we wanted to start this README with a couple of examples.</p>
</div>
<div class="sect2">
<h3 id="_example_i_install_gems_via_homebrew">9.1. Example I. Install Gems via Homebrew</h3>
<div class="paragraph">
<p>Just look at this tiny, five-line script:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash"><span class="c">#!/usr/bin/env bash</span>

<span class="nb">source</span> <span class="k">${</span><span class="nv">BASHMATIC_HOME</span><span class="k">}</span>/init.sh

h2 <span class="s2">"Installing ruby gem sym and brew package curl..."</span> <span class="se">\</span>
   <span class="s2">"Please standby..."</span>

gem.install <span class="s2">"sym"</span> <span class="o">&amp;&amp;</span> brew.install.package <span class="s2">"curl"</span> <span class="o">&amp;&amp;</span> <span class="se">\</span>
  success <span class="s2">"installed sym ruby gem, version </span><span class="si">$(</span>gem.version sym<span class="si">)</span><span class="s2">"</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Results in this detailed and, let&#8217;s be honest, <em>gorgeous</em> ASCII output:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="doc/img/bashmatic-example.png" alt="example" width="100%">
</div>
</div>
<div class="paragraph">
<p>Tell me you are not at all excited to start writing complex installation flows in BASH right away?</p>
</div>
<div class="paragraph">
<p>Not only you get pretty output, but you can each executed command, it&#8217;s exit status, whether it&#8217;s been successful (green/red), as well each command&#8217;s bloody duration in milliseconds. What&#8217;s not to like?!?</p>
</div>
<div class="paragraph">
<p>Still not convinced?</p>
</div>
<div class="paragraph">
<p>Take a look at a more comprehensive example next.</p>
</div>
</div>
<div class="sect2">
<h3 id="_example_ii_download_and_install_binaries">9.2. Example II: Download and install binaries.</h3>
<div class="paragraph">
<p>In this example, we&#8217;ll download and install binaries <code>kubectl</code> and <code>minikube</code> binaries into <code>/usr/local/bin</code></p>
</div>
<div class="paragraph">
<p>We provided an example script in <a href="examples/k8s-installer.sh"><code>examples/k8s-installer.sh</code></a>. Please click and take a look at the source.</p>
</div>
<div class="paragraph">
<p>Here is the output of running this script:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="doc/img/k8installer.png" alt="K8 Minicube Installer" width="100%">
</div>
</div>
<div class="paragraph">
<p>Why do we think this type of installer is pretty awesome, compared to a silent but deadly shell script that "Jim-in-the-corner" wrote and now nobody understands?</p>
</div>
<div class="paragraph">
<p>Because:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The script goes out of its way to over-communicate what it does to the user.</p>
</li>
<li>
<p>It allows and reminds about a clean getaway (Ctrl-C)</p>
</li>
<li>
<p>It shares the exact command it runs and its timings so that you can eyeball issues like network congestions or network addresses, etc.</p>
</li>
<li>
<p>It shows in green exit code '0' of each command. Should any of the commands fail, you&#8217;ll see it in red.</p>
</li>
<li>
<p>Its source code is terse, explicit, and easy to read. There is no magic. Just BASH functions.</p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If you need to create a BASH installer, <em>Bashmatic®</em> offers some incredible time savers.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Let&#8217;s get back to the Earth, and talk about how to install Bashmatic, and how to use it in more detail right after.</p>
</div>
</div>
<div class="sect2">
<h3 id="_example_iii_developer_environment_bootstrap_script">9.3. Example III: Developer Environment Bootstrap Script</h3>
<div class="paragraph">
<p>This final and most feature-rich example is not just an example – <strong>it&#8217;s a working functioning tool that can be used to install a bunch of developer dependencies on your Apple Laptop</strong>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
the script relies on Homebrew behind the scenes, and therefore would not work on Linux or Windows (unless Brew gets ported there).
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>It&#8217;s located in <a href="https://github.com/kigster/bashmatic/blob/main/bin/dev-setup"><code>bin/dev-setup</code></a> and has many CLI flags:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="doc/img/dev-setup.png" alt="Developer Setup" width="100%">
</div>
</div>
<div class="paragraph">
<p>In the example below we&#8217;ll use <code>dev-setup</code> script to install the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Dev Tools</p>
</li>
<li>
<p>PostgreSQL</p>
</li>
<li>
<p>Redis</p>
</li>
<li>
<p>Memcached</p>
</li>
<li>
<p>Ruby 2.7.1</p>
</li>
<li>
<p>NodeJS/NPM/Yarn</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Despite that this is a long list, we can install it all in one command.</p>
</div>
<div class="paragraph">
<p>We&#8217;ll run this from a folder where our application is installed, because then the Ruby Version will be auto-detected from our <code>.ruby-version</code> file, and in addition to installing all the dependencies the script will also run <code>bundle install</code> and <code>npm install</code> (or <code>yarn install</code>). Not bad, huh?</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash"><span class="k">${</span><span class="nv">BASHMATIC_HOME</span><span class="k">}</span>/bin/dev-setup <span class="se">\</span>
  <span class="nt">-g</span> <span class="s2">"ruby postgres mysql caching js monitoring"</span> <span class="se">\</span>
  <span class="nt">-r</span> <span class="si">$(</span><span class="nb">cat</span> .ruby-version<span class="si">)</span> <span class="se">\</span>
  <span class="nt">-p</span> 9.5 <span class="se">\ </span><span class="c"># use PostgreSQL version 9.5</span>
  <span class="nt">-m</span> 5.6   <span class="c"># use MySQL version 5.6</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This compact command line installs a ton of things, but don&#8217;t take our word for it - run it yourself. Or, at the very least enjoy this <a href="https://github.com/kigster/bashmatic/blob/main/.dev-setup-completed.png">one extremely long screenshot</a> :)</p>
</div>
</div>
<div class="sect2">
<h3 id="_example_iv_installing_grc_colourify_tool">9.4. Example IV: Installing GRC Colourify Tool</h3>
<div class="paragraph">
<p>This is a great tool that colorizes nearly any other tool''s output.</p>
</div>
<div class="paragraph">
<p>Run it like so:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash"><span class="k">${</span><span class="nv">BASHMATIC_HOME</span><span class="k">}</span>/bin/install-grc</code></pre>
</div>
</div>
<div class="paragraph">
<p>You might need to enter your password for SUDO.</p>
</div>
<div class="paragraph">
<p>Once it completes, run <code>source ~/.bashrc</code> (or whatever shell you use), and type something like <code>ls -al</code> or <code>netstat -rn</code> or <code>ping 1.1.1.1</code> and notice how all of the above is nicely colored.</p>
</div>
</div>
<div class="sect2">
<h3 id="_example_v_db_shortcut_for_database_utilities_db_top">9.5. Example V: <code>db</code> Shortcut for Database Utilities &amp; <code>db top</code></h3>
<div class="paragraph">
<p>If you are using PostgreSQL, you are in luck! Bashmatic includes numerous helpers for PostreSQL&#8217;s CLI
utility <code>psql</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Before you begin, we recommend that you install file <code>.psqlrc</code> from Bashmatic&#8217;s <code>conf</code> directory into your home folder. While not required, this file sets up your prompt and various macros for PostgreSQL that will come very handy if you use <code>psql</code> with any regularity.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>What is <code>db top</code> anyway?</p>
</div>
<div class="paragraph">
<p>Just like with the regular <code>top</code> you can see the "top" resource-consuming processes running on your local system, with <code>dbtop</code> you can observe a self-refreshing report of the actively running queries on up to <strong>three database servers</strong> at the same time.</p>
</div>
<div class="paragraph">
<p>Here is the pixelated screenshot of <code>dbtop</code> running against two live databases:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<a class="image" href="https://github.com/kigster/bashmatic/blob/main/FUNCTIONS.adoc#db-top"><img src="doc/img/dbtop.png" alt="DBTop Example" width="100%"></a>
</div>
</div>
<div class="paragraph">
<p>In order for this to work, you must first define database connection parameters in a YAML file located at the following PATH: <code>~/.db/database.yml</code>.</p>
</div>
<div class="paragraph">
<p>Here is how the file should be organized (if you ever used Ruby on Rails, the standard <code>config/database.yml</code> file should be fully compatible):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="yaml"><span class="na">development</span><span class="pi">:</span>
  <span class="na">database</span><span class="pi">:</span> <span class="s">development</span>
  <span class="na">username</span><span class="pi">:</span> <span class="s">postgres</span>
  <span class="na">host</span><span class="pi">:</span> <span class="s">localhost</span>
  <span class="na">password</span><span class="pi">:</span>
<span class="na">staging</span><span class="pi">:</span>
  <span class="na">database</span><span class="pi">:</span> <span class="s">staging</span>
  <span class="na">username</span><span class="pi">:</span> <span class="s">postgres</span>
  <span class="na">host</span><span class="pi">:</span> <span class="s">staging.db.example.com</span>
  <span class="na">password</span><span class="pi">:</span>
<span class="na">production</span><span class="pi">:</span>
  <span class="na">database</span><span class="pi">:</span> <span class="s">production</span>
  <span class="na">username</span><span class="pi">:</span> <span class="s">postgres</span>
  <span class="na">host</span><span class="pi">:</span> <span class="s">production.db.example.com</span>
  <span class="na">password</span><span class="pi">:</span> <span class="s2">"</span><span class="s">a098098safdaf0998ff79789a798a7sdf"</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Given the above file, you should be able to run the following command to see all available (registered in the above YAML file) connections:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash"><span class="nv">$ </span>db connections
development
staging
production</code></pre>
</div>
</div>
<div class="paragraph">
<p>Once that&#8217;s working, you should be able run <code>dbtop</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash">db top development staging production</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
At the moment, only the default port 5432 is supported. If you are using an alternative port, and as long as it&#8217;s shared across the connections you can set the <code>PGPORT</code> environment variable that <code>psql</code> will read.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>DB Top Configuration</strong>:</p>
</div>
<div class="paragraph">
<p>You can configure the following settings for <code>db top</code>:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>You can change the location of the <code>database.yml</code> file with <code>db.config.set-file &lt;filepath&gt;</code></p>
</li>
<li>
<p>You can change the refresh rate of the <code>dbtop</code> with eg. <code>db.top.set-refresh 0.5</code> (in seconds, fractional values allowed). This sets the sleep time between the screen is fully refreshed.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_other_db_functions">9.6. Other <code>db</code> Functions</h3>
<div class="paragraph">
<p>If you run <code>db</code> without any arguments, or with <code>-h</code> you will see the following:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="doc/img/db.png" alt="db usage" width="100%">
</div>
</div>
<div class="paragraph">
<p>As you might notice, there is an ever-growing list of "actions" — the sub-commands to the <code>db</code> script.</p>
</div>
</div>
<div class="sect2">
<h3 id="_sub_commands_of_db">9.7. Sub-Commands of <code>db</code></h3>
<div class="paragraph">
<p>You can view the full list by passing <code>--commands</code> flag:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="doc/img/db-commands.png" alt="db usage" width="100%">
</div>
</div>
<div class="paragraph">
<p>Altgernatively, here is the <code>--examples</code> view:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="doc/img/db-examples.png" alt="db examples" width="100%">
</div>
</div>
<div class="sect3">
<h4 id="_sub_command_db_connections">9.7.1. Sub-Command <code>db connections</code></h4>
<div class="paragraph">
<p>You can get a list of all availabled db connections with either</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash">db connections
<span class="c"># OR</span>
db <span class="nt">--connections</span></code></pre>
</div>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="doc/img/db-connections.png" alt="db usage" width="100%">
</div>
</div>
</div>
<div class="sect3">
<h4 id="_sub_command_db_pga_eg_pg_activity">9.7.2. Sub-Command <code>db pga</code> (eg. <code>pg_activity</code>)</h4>
<div class="paragraph">
<p>For instance, a recent addition is the ability to invoke <a href="https://github.com/dalibo/pg_activity">pg_activity</a> Python-based DB "top", a much more advanced top query monitor for PostgreSQL.</p>
</div>
<div class="paragraph">
<p>You can invoke <code>db pga &lt;connection&gt;</code> where the connection is taken from the database connection definitions shown above. This is what <code>pg-activity</code> looks like in action:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="doc/img/db-pga.png" alt="pg_activity" width="100%">
</div>
</div>
</div>
<div class="sect3">
<h4 id="_other_sub_commands">9.7.3. Other Sub-Commands</h4>
<div class="paragraph">
<p>Once you know what database you are connecting to, you can then run one of the commands:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">db connect &lt;connection&gt;</dt>
<dd>
<p>opens psql session to the given connection</p>
</dd>
<dt class="hdlist1">db db-settings-toml &lt;connection&gt;</dt>
<dd>
<p>prints all PostgreSQL settings (obtained with <code>show all</code>) as a sorted TOML-formatted file.</p>
</dd>
<dt class="hdlist1">db -q list-tables &lt;connection&gt;</dt>
<dd>
<p>print a  list of all tables in the given database, -q (or --quiet) skips  printing the header so that only the table listing is printed.</p>
</dd>
<dt class="hdlist1">db csv &lt;connection&gt; &lt;query&gt;</dt>
<dd>
<p>export the result of the query as a CSV to STDOUT, eg</p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash"><span class="nv">$ </span>db csv filestore <span class="s2">"select * from files limit 2"</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Results in the following output</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="CSV">component_id,file_path,fingerprint_sha_256,fingerprint_comment_stripped_sha_256,license_info
6121f5b3-d68d-479d-9b83-77e9ca07dd2b,weiboSDK/src/main/java/com/sina/weibo/sdk/openapi/models/Tag.java,
6121f5b3-d68d-479d-9b83-77e9ca07dd2b,weiboSDK/src/main/java/com/sina/weibo/sdk/openapi/models/Comment.java,</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_bintablet_script">9.8. <code>bin/tablet</code> Script</h3>
<div class="paragraph">
<p>Building atop of the powerful <code>db</code> script mechanics, is another powerful script called <code>tablet</code>.</p>
</div>
<div class="paragraph">
<p>The script is meant to be run against one database, and perform a table-level operation on a set of tables that can be specified in numerous ways. It started with the need to ANALYZE only some of the tables, specifically those that have not been auto-analyzed, but grew into a much more capable tool that can do things like:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Analyze all tables in a database that have never been analyzed`</p>
</li>
<li>
<p>Analyze all tables in a database that have not been analyzed in N days</p>
</li>
<li>
<p>Analyze a set of specific tables, or exclude tables using regular expression</p>
</li>
<li>
<p>Instead of analyzing tables, perform any other table-level command such as:</p>
<div class="ulist">
<ul>
<li>
<p><code>TRUNCATE</code></p>
</li>
<li>
<p><code>VACUUM</code> and <code>VACCUUM FULL</code></p>
</li>
<li>
<p><code>DROP TABLE</code></p>
</li>
<li>
<p><code>REINDEX TABLE</code></p>
</li>
<li>
<p>etc..</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Below is the screenshot of the help screen from this script:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="doc/img/bashmatic-tablet.png" alt="Tablet Script in Action" width="100%">
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_usage">10. Usage</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Welcome to <strong>Bashmatic</strong> – an ever growing collection of scripts and mini-bash frameworks for doing all sorts of things quickly and efficiently.</p>
</div>
<div class="paragraph">
<p>We have adopted the <a href="https://google.github.io/styleguide/shell.xml">Google Bash Style Guide</a>, and it&#8217;s recommended that anyone committing to this repo reads the guides to understand the conventions, gotchas and anti-patterns.</p>
</div>
<div class="sect2">
<h3 id="_function_naming_convention_unpacked">10.1. Function Naming Convention Unpacked</h3>
<div class="paragraph">
<p><em>Bashmatic®</em> provides a large number of functions, which are all loaded in your current shell. The functions are split into two fundamental groups:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Functions with names beginning with a <code>.</code> are considered "private" functions, for example <code>.run.env</code> and <code>.run.initializer</code></p>
</li>
<li>
<p>All other functions are considered public.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following conventions apply to all functions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>We use the "dot" for separating namespaces, hence <code>git.sync</code> and <code>gem.install</code>.</p>
</li>
<li>
<p>Function names should be self-explanatory and easy to read.</p>
</li>
<li>
<p>DO NOT abbreviate words.</p>
</li>
<li>
<p>All public functions must be written defensively: i.e., if the function is called from the Terminal without any arguments, and it requires arguments, the function <em>must print its usage info</em> and a meaningful error message.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For instance:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash"><span class="nv">$ </span>gem.install
┌─────────────────────────────────────────────────────────┐
│  « ERROR »  Error - gem name is required as an argument │
└─────────────────────────────────────────────────────────┘</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now let&#8217;s run it properly:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash"><span class="nv">$ </span>gem.install simple-feed
       installing simple-feed <span class="o">(</span>latest<span class="o">)</span>...
  ✔︎    <span class="nv">$ </span>gem <span class="nb">install </span>simple-feed   ▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪〔   5685 ms 〕    0
  ✔︎    <span class="nv">$ </span>gem list <span class="o">&gt;</span> <span class="k">${</span><span class="nv">BASHMATIC_TEMP</span><span class="k">}</span>/.gem/gem.list ▪▪▪▪▪▪〔    503 ms 〕    0</code></pre>
</div>
</div>
<div class="paragraph">
<p>The naming convention we use is a derivative of Google&#8217;s Bash StyleGuide, using <code>.</code> to separate BASH function namespaces instead of much more verbose <code>::</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_seeing_all_functions">10.2. Seeing All Functions</h3>
<div class="paragraph">
<p>After running the above, run <code>bashmatic.functions</code> function to see all available functions. You can also open the <a href="doc/FUNCTIONS.html">FUNCTIONS.adoc</a> file to see the alphabetized list of all 422 functions.</p>
</div>
</div>
<div class="sect2">
<h3 id="_seeing_specific_functions">10.3. Seeing Specific Functions</h3>
<div class="paragraph">
<p>To get a list of module or pattern-specific functions installed by the framework, run the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash"><span class="nv">$ </span>bashmatic.functions-from pattern <span class="o">[</span> columns <span class="o">]</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>For instance:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash"><span class="nv">$ </span>bashmatic.functions-from docker 2
docker.abort-if-down                    docker.build.container
docker.actions.build                    docker.containers.clean
.......
docker.actions.update</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_various_modules">10.4. Various Modules</h3>
<div class="paragraph">
<p>You can list various modules by listing the <code>lib</code> sub-directory of the <code>${BASHMATIC_HOME}</code> folder.</p>
</div>
<div class="paragraph">
<p>Note how we use <em>Bashmatic®</em> helper <code>columnize [ columns ]</code> to display a long list in five columns.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash"><span class="nv">$ </span><span class="nb">ls</span> <span class="nt">-1</span> <span class="k">${</span><span class="nv">BASHMATIC_HOME</span><span class="k">}</span>/lib | <span class="nb">sed</span> <span class="s1">'s/\.sh//g'</span> | columnize 5
7z                deploy            jemalloc          runtime-config    <span class="nb">time
</span>array             <span class="nb">dir               </span>json              runtime           <span class="nb">trap
</span>audio             docker            net               <span class="nb">set               </span>url
aws               file              osx               <span class="nb">set               </span>user
bashmatic         ftrace            output            settings          util
brew              gem               pids              shell-set         vim
<span class="nb">caller            </span>git-recurse-updat progress-bar      ssh               yaml
color             git               ruby              subshell
db                sedx              run               sym</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_key_modules_explained">10.5. Key Modules Explained</h3>
<div class="paragraph">
<p>At a high level, the following modules are provided, in order of importance:</p>
</div>
<div class="sect3">
<h4 id="_runtime_framework_executing_commands_the_right_way">10.5.1. Runtime Framework — Executing Commands The Right Way™</h4>
<div class="paragraph">
<p>One of the key parts of Bashmatic is the framework around running commands and reporting on their execution status.</p>
</div>
<div class="paragraph">
<p>The two most important functions in this framework are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>run.set-next [ option option &#8230;&#8203; ]</code></p>
</li>
<li>
<p><code>run.set-all [ option option &#8230;&#8203; ]</code></p>
</li>
<li>
<p><code>run "command"</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The first two allow you to configure how the <code>run</code> command behaves. The <code>run.set-next</code> only affects the first invocation of <code>run</code>. After that all runtime options revert to the defaults.</p>
</div>
<div class="paragraph">
<p><code>run.set-all</code> affects ALL <code>run</code> invocations following it.</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p>The following options can be passed to the <code>run.set-next</code> and <code>run.set-all</code>:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">abort-on-error</dt>
<dd>
<p>exits the script when the command fails.</p>
</dd>
<dt class="hdlist1">ask-on-error</dt>
<dd>
<p>interactively asks the user when the command fails.</p>
</dd>
<dt class="hdlist1">continue-on-error</dt>
<dd>
<p>prints a warning, and continues when the command fails.</p>
<hr>
</dd>
<dt class="hdlist1">dry-run-on</dt>
<dd>
<p>turns dry-run on</p>
</dd>
<dt class="hdlist1">dry-run-off</dt>
<dd>
<p>turns dry-run off</p>
<hr>
</dd>
<dt class="hdlist1">on-decline-exit</dt>
<dd>
<p>when <code>run.ui.ask</code> is used and user says NO, exits the program.</p>
</dd>
<dt class="hdlist1">on-decline-return</dt>
<dd>
<p>when <code>run.ui.ask</code> is used and user says NO, returns from the function.</p>
<hr>
</dd>
<dt class="hdlist1">show-command-on</dt>
<dd>
<p>shows the command being executed</p>
</dd>
<dt class="hdlist1">show-command-off</dt>
<dd>
<p>silently executes the command</p>
<hr>
</dd>
<dt class="hdlist1">show-output-off</dt>
<dd>
<p>swallows command&#8217;s STDOUT, but prints STDERR on error</p>
</dd>
<dt class="hdlist1">show-output-on</dt>
<dd>
<p>prints STDOUT of the command as it executes</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code>❯ run.set-next show-output-off; run "ls -1 | wc -l";  run.set-next show-output-on; run "ls -1 | wc -l";
  ✔︎   ❯ ls -1 | wc -l ▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪〔     74 ms 〕    0
       # Command below will be shown with its output:
       ❯ ls -1 | wc -l
      17

  ✔︎  ▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪▪〔     80 ms 〕    0</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following files provide this functionality:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>lib/run.sh</code></p>
</li>
<li>
<p><code>lib/runtime.sh</code></p>
</li>
<li>
<p><code>lib/runtime-config.sh</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These collectively offer the following functions:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash"><span class="nv">$ </span>bashmatic.functions-from <span class="s1">'run*'</span>

run                                  run.set-next
run.config.detail-is-enabled         run.set-next.list
run.config.verbose-is-enabled        run.ui.ask
run.inspect                          run.ui.ask-user-value
run.inspect-variable                 run.ui.get-user-value
run.inspect-variables                run.ui.press-any-key
run.inspect-variables-that-are       run.ui.retry-command
run.inspect.set-skip-false-or-blank  run.variables-ending-with
run.on-error.ask-is-enabled          run.variables-starting-with
run.print-variable                   run.with.minimum-duration
run.print-variables                  run.with.ruby-bundle
run.set-all                          run.with.ruby-bundle-and-output
run.set-all.list</code></pre>
</div>
</div>
<div class="paragraph">
<p>Using these functions you can write powerful shell scripts that display each command they run, its status, duration, and can abort on various conditions. You can ask the user to confirm, and you can show a user message and wait for any key pressed to continue.</p>
</div>
<div class="sect4">
<h5 id="_examples_of_runtime_framework">Examples of Runtime Framework</h5>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>NOTE, in the following examples we assume you installed the library into your project&#8217;s folder as <code>.bashmatic</code> (a "hidden" folder starting with a dot).</p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>Programming style used in this project lends itself nicely to using a DSL-like approach to shell programming.  For example, in order to configure the behavior of the run-time framework (see below) you would run the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash"><span class="c">#!/usr/bin/env bash</span>

<span class="c"># (See below on the location of .bashmatic and ways to install it)</span>
<span class="nb">source</span> <span class="k">${</span><span class="nv">BASHMATIC_HOME</span><span class="k">}</span>/init.sh

<span class="c"># configure global behavior of all run() invocations</span>
run.set-all abort-on-error show-output-off

run <span class="s2">"git clone https://gthub.com/user/rails-repo rails"</span>
run <span class="s2">"cd rails"</span>
run <span class="s2">"bundle check || bundle install"</span>

<span class="c"># the following configuration only applies to the next invocation of `run()`</span>
<span class="c"># and then resets back to `off`</span>
run.set-next show-output-on
run <span class="s2">"bundle exec rspec"</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>And most importantly, you can use our fancy UI drawing routines to communicate with the user, which are based on familiar HTML constructs, such as <code>h1</code>, <code>h2</code>, <code>hr</code>, etc.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_controlling_output">10.5.2. Controlling Output</h4>
<div class="paragraph">
<p>A large chunk of Bashmatic is devoted to printing pretty dialogs and controlling the output of program execution.</p>
</div>
<div class="paragraph">
<p>The <code>lib/output.sh</code> module does all of the heavy lifting with providing many UI elements, such as frames, boxes, lines, headers, and many more.</p>
</div>
<div class="paragraph">
<p>Here is the list of functions in this module:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash"><span class="nv">$ </span>bashmatic.functions-from output 3
abort                 error:               left-prefix
ascii-clean           h.black              ok
box.blue-in-green     h.blue               okay
box.blue-in-yellow    h.green              output.color.off
box.green-in-cyan     h.red                output.color.on
box.green-in-green    h.yellow             output.is-pipe
box.green-in-magenta  h1                   output.is-redirect
box.green-in-yellow   h1.blue              output.is-ssh
box.magenta-in-blue   h1.green             output.is-terminal
box.magenta-in-green  h1.purple            output.is-tty
box.red-in-magenta    h1.red               puts
box.red-in-red        h1.yellow            reset-color
box.red-in-yellow     h2                   reset-color:
box.yellow-in-blue    h2.green             screen-width
box.yellow-in-red     h3                   screen.height
box.yellow-in-yellow  hdr                  screen.width
br                    hl.blue              shutdown
center                hl.desc              stderr
columnize             hl.green             stdout
command-spacer        hl.orange            success
cursor.at.x           hl.subtle            test-group
cursor.at.y           hl.white-on-orange   ui.closer.kind-of-ok
cursor.down           hl.white-on-salmon   ui.closer.kind-of-ok:
cursor.left           hl.yellow            ui.closer.not-ok
cursor.rewind         hl.yellow-on-gray    ui.closer.not-ok:
cursor.right          hr                   ui.closer.ok:
cursor.up             hr.colored           warn
debug                 inf                  warning
duration              info                 warning:
err                   info:
error                 left</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that some function names end with <code>:</code> – this indicates that the function outputs a new-line in the end. These functions typically exist together with their non-<code>:</code>-terminated counter-parts.  If you use one, eg, <code>inf</code>, you are then supposed to finish the line by providing an additional output call, most commonly it will be one of <code>ok:</code>, <code>ui.closer.not-ok:</code> and <code>ui.closer.kind-of-ok:</code>.</p>
</div>
<div class="paragraph">
<p>Here is an example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash"><span class="k">function </span>valid-cask<span class="o">()</span>  <span class="o">{</span> <span class="nb">sleep </span>1<span class="p">;</span> <span class="k">return </span>0<span class="p">;</span> <span class="o">}</span>
<span class="k">function </span>verify-cask<span class="o">()</span> <span class="o">{</span>
  inf <span class="s2">"verifying brew cask </span><span class="k">${</span><span class="nv">1</span><span class="k">}</span><span class="s2">...."</span>
  <span class="k">if </span>valid-cask <span class="k">${</span><span class="nv">1</span><span class="k">}</span><span class="p">;</span> <span class="k">then
    </span>ok:
  <span class="k">else
    </span>not-ok:
  <span class="k">fi</span>
<span class="o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>When you run this, you should see something like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash"> <span class="nv">$ </span>verify-cask TextMate
   ✔︎  verifying brew cask TextMate....</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the above example, you see the checkbox appear to the left of the text. In fact, it appears a second after, right as <code>sleep 1</code> returns. This is because this paradigm is meant for wrapping constructs that might succeed or fail.</p>
</div>
<div class="paragraph">
<p>If we change the <code>valid-cask</code> function to return a failure:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash"><span class="k">function </span>valid-cask<span class="o">()</span>  <span class="o">{</span> <span class="nb">sleep </span>1<span class="p">;</span> <span class="k">return </span>1<span class="p">;</span> <span class="o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Then this is what we&#8217;d see:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash"><span class="nv">$ </span>verify-cask TextMate
  ✘    verifying brew cask TextMate....</code></pre>
</div>
</div>
<div class="sect4">
<h5 id="_output_components">Output Components</h5>
<div class="paragraph">
<p>Components are BASH functions that draw something concrete on the screen. For instance, all functions starting with <code>box.</code> are components, as are <code>h1</code>, <code>h2</code>, <code>hr</code>, <code>br</code> and more.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash"><span class="nv">$ </span>h1 Hello

┌───────────────────┐
│ Hello             │
└───────────────────┘</code></pre>
</div>
</div>
<div class="paragraph">
<p>These are often named after HTML elements, such as <code>hr</code>, <code>h1</code>, <code>h2</code>, etc.</p>
</div>
</div>
<div class="sect4">
<h5 id="_output_helpers">Output Helpers</h5>
<div class="paragraph">
<p>Here is another example where we are deciding whether to print something based on whether the output is a proper terminal (and not a pipe or redirect):</p>
</div>
<div class="listingblock">
<div class="content">
<pre>output.is-tty &amp;&amp; h1 "Yay For Terminals!"
output.has-stdin &amp;&amp; echo "We are being piped into..."</pre>
</div>
</div>
<div class="paragraph">
<p>The above reads more like a high level language like Ruby or Python than Shell. That&#8217;s because BASH is more powerful than most people think.</p>
</div>
<div class="paragraph">
<p>There is an <a href="examples/test-ui.sh">example script</a> that demonstrates the capabilities of Bashmatic.</p>
</div>
<div class="paragraph">
<p>If you ran the script, you should see the output shown <a href=".bashmatic.png">in this screenshot</a>. Your colors may vary depending on what color scheme and font you use for your terminal.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_package_management_brew_and_rubygems">10.5.3. Package management: Brew and RubyGems</h4>
<div class="paragraph">
<p>You can reliably install ruby gems or brew packages with the following syntax:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash"><span class="c">#!/usr/bin/env bash</span>

<span class="nb">source</span> <span class="k">${</span><span class="nv">BASHMATIC_HOME</span><span class="k">}</span>/init.sh
h2 <span class="s2">"Installing ruby gem sym and brew package curl..."</span>
gem.install sym
brew.install.package curl

success <span class="s2">"installed Sym version </span><span class="si">$(</span>gem.version sym<span class="si">)</span><span class="s2">"</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>When you run the above script, you shyould seee the following output:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="doc/img/bashmatic-example.png" alt="example" width="100%">
</div>
</div>
</div>
<div class="sect3">
<h4 id="_shortening_urls_and_github_access">10.5.4. Shortening URLs and Github Access</h4>
<div class="paragraph">
<p>You can shorten URLs on the command line using Bitly, but for this to work, you must set the following environment variables in your shell init:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash"><span class="nb">export </span><span class="nv">BITLY_LOGIN</span><span class="o">=</span><span class="s2">"&lt;your login&gt;"</span>
<span class="nb">export </span><span class="nv">BITLY_API_KEY</span><span class="o">=</span><span class="s2">"&lt;your api key&gt;"</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Then you can run it like so:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash"><span class="nv">$ </span>url.shorten https://raw.githubusercontent.com/kigster/bashmatic/main/bin/install
<span class="c"># http://bit.ly/2IIPNE1</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_github_access">10.5.5. Github Access</h4>
<div class="paragraph">
<p>There are a couple of Github-specific helpers:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash">github.clone                  github.setup
github.org                    github.validate</code></pre>
</div>
</div>
<div class="paragraph">
<p>For instance:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash"><span class="nv">$ </span>github.clone sym

  ✘    Validating Github Configuration...

       Please enter the name of your Github Organization:
       <span class="nv">$ </span>kigster

  Your github organization was saved <span class="k">in </span>your ~/.gitconfig file.
  To change it <span class="k">in </span>the future, run:

       <span class="nv">$ </span>github.org &lt;org-name&gt;

  ✔︎ <span class="nv">$ </span>git clone git@github.com:kigster/sym ▪▪▪▪▪▪〔     931 ms 〕</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_file_helpers">10.5.6. File Helpers</h4>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash"><span class="nv">$ </span>bashmatic.functions-from file

file.exists_and_newer_than     file.list.filter-non-empty
file.gsub                      file.size
file.install-with-backup       file.size.mb
file.last-modified-date        file.source-if-exists
file.last-modified-year        file.stat
file.list.filter-existing</code></pre>
</div>
</div>
<div class="paragraph">
<p>For instance, <code>file.stat</code> offers access to the <code>fstat()</code> C-function:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash"> <span class="nv">$ </span>file.stat README.md st_size
22799</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_array_helpers">10.5.7. Array Helpers</h4>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash"><span class="nv">$ </span>bashmatic.functions-from array

array.to.bullet-list         array.includes
array.has-element            array.includes-or-exit
array.to.csv                 array.from.stdin
array-join                   array.join
array-piped                  array.to.piped-list
array.includes-or-complain</code></pre>
</div>
</div>
<div class="paragraph">
<p>For instance:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash"><span class="nv">$ </span><span class="nb">declare</span> <span class="nt">-a</span> <span class="nv">farm_animals</span><span class="o">=(</span>chicken duck rooster pig<span class="o">)</span>
<span class="nv">$ </span>array.to.bullet-list <span class="k">${</span><span class="nv">farm_animals</span><span class="p">[@]</span><span class="k">}</span>
 • chicken
 • duck
 • rooster
 • pig
<span class="nv">$ </span>array.includes <span class="s2">"duck"</span> <span class="s2">"</span><span class="k">${</span><span class="nv">farm_animals</span><span class="p">[@]</span><span class="k">}</span><span class="s2">"</span> <span class="o">&amp;&amp;</span> <span class="nb">echo </span>Yes <span class="o">||</span> <span class="nb">echo </span>No
Yes
<span class="nv">$ </span>array.includes  <span class="s2">"cow"</span> <span class="s2">"</span><span class="k">${</span><span class="nv">farm_animals</span><span class="p">[@]</span><span class="k">}</span><span class="s2">"</span> <span class="o">&amp;&amp;</span> <span class="nb">echo </span>Yes <span class="o">||</span> <span class="nb">echo </span>No
No</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_utilities">10.5.8. Utilities</h4>
<div class="paragraph">
<p>The utilities module has the following functions:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash"><span class="nv">$ </span>bashmatic.functions-from util

pause.long                     util.install-direnv
pause                          util.is-a-function
pause.short                    util.is-numeric
pause.medium                   util.is-variable-defined
util.append-to-init-files      util.lines-in-folder
util.arch                      util.remove-from-init-files
util.call-if-function          util.shell-init-files
shasum.sha-only                util.shell-name
shasum.sha-only-stdin          util.ver-to-i
util.functions-starting-with   util.whats-installed
util.generate-password         watch.ls-al</code></pre>
</div>
</div>
<div class="paragraph">
<p>For example, version helpers can be very handy in automated version detection, sorting and identifying the latest or the oldest versions:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash"><span class="nv">$ </span>util.ver-to-i <span class="s1">'12.4.9'</span>
112004009
<span class="nv">$ </span>util.i-to-ver <span class="si">$(</span>util.ver-to-i <span class="s1">'12.4.9'</span><span class="si">)</span>
12.4.9</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_ruby_and_ruby_gems">10.5.9. Ruby and Ruby Gems</h4>
<div class="paragraph">
<p><a href="lib/ruby.sh">Ruby Version Helpers</a> and <a href="lib/gem.sh">Ruby Gem Helpers</a>, that can extract curren gem version from either <code>Gemfile.lock</code> or globally installed gem list.</p>
</div>
<div class="paragraph">
<p>Additional Ruby helpers abound:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash"><span class="nv">$ </span>bashmatic.functions-from ruby

bundle.gems-with-c-extensions  ruby.install-ruby-with-deps
interrupted                    ruby.install-upgrade-bundler
ruby.bundler-version           ruby.installed-gems
ruby.compiled-with             ruby.kigs-gems
ruby.default-gems              ruby.linked-libs
ruby.full-version              ruby.numeric-version
ruby.gemfile-lock-version      ruby.rbenv
ruby.gems                      ruby.rubygems-update
ruby.gems.install              ruby.stop
ruby.gems.uninstall            ruby.top-versions
ruby.init                      ruby.top-versions-as-yaml
ruby.install                   ruby.validate-version
ruby.install-ruby</code></pre>
</div>
</div>
<div class="paragraph">
<p>From the obvious <code>ruby.install-ruby &lt;version&gt;</code> to incredibly useful <code>ruby.top-versions &lt;platform&gt;</code> – which, using rbenv and ruby_build plugin, returns the most recent minor version of each major version upgrade, as well as the YAML version that allows you to pipe the output into your <code>.travis.yml</code> to test against each major version of Ruby, locked to the very latest update in each.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash"><span class="nv">$ </span>ruby.top-versions
2.0.0-p648
2.1.10
2.2.10
2.3.8
2.4.9
2.5.7
2.6.5
2.7.0
2.8.0-dev

<span class="nv">$ </span>ruby.top-versions jruby
jruby-1.5.6
jruby-1.6.8
jruby-1.7.27
jruby-9.0.5.0
jruby-9.1.17.0
jruby-9.2.10.0

<span class="nv">$ </span>ruby.top-versions mruby
mruby-dev
mruby-1.0.0
mruby-1.1.0
mruby-1.2.0
mruby-1.3.0
mruby-1.4.1
mruby-2.0.1
mruby-2.1.0</code></pre>
</div>
</div>
<div class="sect4">
<h5 id="_gem_helpers">Gem Helpers</h5>
<div class="paragraph">
<p>These are fun helpers to assist in scripting gem management.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash"><span class="nv">$ </span>bashmatic.functions-from gem

g-i                                           gem.gemfile.version
g-u                                           gem.global.latest-version
gem.cache-installed                           gem.global.versions
gem.cache-refresh                             gem.install
gem.clear-cache                               gem.is-installed
gem.configure-cache                           gem.uninstall
gem.ensure-gem-version                        gem.version</code></pre>
</div>
</div>
<div class="paragraph">
<p>For instance</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash"><span class="nv">$ </span>g-i awesome_print
  ✔︎    gem awesome_print <span class="o">(</span>1.8.0<span class="o">)</span> is already installed
<span class="nv">$ </span>gem.version awesome_print
1.8.0</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_audio_video_compression_helpers">10.5.10. Audio &amp; Video Compression Helpers</h4>
<div class="paragraph">
<p>You can discover the audio and video functions using <code>bashmatic.functions</code> helper:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash"> ❯ bashmatic.functions 1 | egrep <span class="nt">-i</span> <span class="s1">'video|audio'</span>
audio.dir.mp3-to-wav
audio.dir.rename-karaoke-wavs
audio.dir.rename-wavs
audio.file.frequency
audio.file.mp3-to-wav
audio.make.mp3
audio.make.mp3.usage
audio.make.mp3s
video-squeeze
video.convert.compress</code></pre>
</div>
</div>
<div class="paragraph">
<p>These commands auto-install ffmpeg and other utilities, and then use best in class compression. For instance, here is 80% compressed video file:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="doc/img/video-squeeze.png" alt="Video Squeeze" width="100%">
</div>
</div>
</div>
<div class="sect3">
<h4 id="_additional_helpers">10.5.11. Additional Helpers</h4>
<div class="paragraph">
<p>There are plenty more modules, that help with:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="lib/aws.sh">AWS helpers</a> – requires <code>awscli</code> and credentials setup, and offers some helpers to simplify AWS management.</p>
</li>
<li>
<p><a href="lib/docker.sh">Docker Helpers</a> – assist with docker image building and pushing/pulling</p>
</li>
<li>
<p><a href="lib/sym.sh">Sym</a> – encryption with the gem called <a href="https://github.com/kigster/sym"><code>sym</code></a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>And many more.</p>
</div>
<div class="paragraph">
<p>See the full function index with the function implementation body in the <a href="doc/FUNCTIONS.html">FUNCTIONS.adoc</a> index.</p>
</div>
<hr>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_guide">11. How To Guide</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_write_new_dsl_in_the_bashmatic_style">11.1. Write new DSL in the <em>Bashmatic®</em> Style</h3>
<div class="paragraph">
<p>The following example is the actual code from a soon to be integrated AWS credentials install script. This code below checks that a user has a local <code>~/.aws/credentials</code> file needed by the <code>awscli</code>, and in the right INI format. If it doesn&#8217;t find it, it checks for the access key CSV file in the <code>~/Downloads</code> folder, and converts that if found. Now, if even that is not found, it prompts the user with instructions on how to generate a new key pair on AWS IAM website, and download it locally, thereby quickly converting and installing it as a proper credentials file. Not bad, for a compact BASH script, right? (of course, you are not seeing all of the involved functions, only the public ones).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash"><span class="c"># define a new function in AWS namespace, related to credentials.</span>
<span class="c"># name of the function is self-explanatory: it validates credentials</span>
<span class="c"># and exits if they are invalid.</span>
aws.credentials.validate-or-exit<span class="o">()</span> <span class="o">{</span>
  aws.credentials.are-valid <span class="o">||</span> <span class="o">{</span>
    aws.credentials.install-if-missing <span class="o">||</span> bashmatic.exit-or-return 1
  <span class="o">}</span>
<span class="o">}</span>

aws.credentials.install-if-missing<span class="o">()</span> <span class="o">{</span>
  aws.credentials.are-present <span class="o">||</span> <span class="o">{</span> <span class="c"># if not present</span>
    aws.access-key.is-present <span class="o">||</span> aws.access-key.download <span class="c"># attempt to download the key</span>
    aws.access-key.is-present <span class="o">&amp;&amp;</span> aws.credentials.check-downloads-folder <span class="c"># attempt to find it in ~/Downloads</span>
  <span class="o">}</span>

  aws.credentials.are-present <span class="o">||</span> <span class="o">{</span> <span class="c"># final check after all attempts to install credentials</span>
    error <span class="s2">"Unable to find AWS credentials. Please try again."</span> <span class="o">&amp;&amp;</span> bashmatic.exit-or-return 1
  <span class="o">}</span>

   bashmatic.exit-or-return 0
<span class="o">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Now, <strong>how would you use it in a script?</strong> Let&#8217;s say you need a script to upload
something to AWS S3. But before you begin, wouldn&#8217;t it be nice to verify
that the credentials exist, and if not – help the user install it? Yes it would.</p>
</div>
<div class="paragraph">
<p>And that is exactly what the code above does, but it looks like a DSL. because
it <em>is</em> a DSL.</p>
</div>
<div class="paragraph">
<p>This script could be your <code>bin/s3-uploader</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash">aws.credentials.validate-or-exit
<span class="c"># if we are here, that means that AWS credentials have been found.</span>
<span class="c"># and we can continue with our script.</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_how_can_i_test_if_the_function_was_ran_as_part_of_a_script_or_sourced_in">11.2. How can I test if the function was ran as part of a script, or "sourced-in"?</h3>
<div class="paragraph">
<p>Some bash files exists as libraries to be "sourced in", and others exist as scripts to be run. But users won&#8217;t always know what is what, and may try to source in a script that should be run, or vice versa - run a script that should be sourced in.</p>
</div>
<div class="paragraph">
<p>What do you, programmer, do to educate the user about correct usage of your script/library?</p>
</div>
<div class="paragraph">
<p><em>Bashmatic®</em> offers a reliable way to test this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash"><span class="c">#!/usr/bin/env bash</span>
<span class="c"># load library</span>
<span class="k">if</span> <span class="o">[[</span> <span class="nt">-f</span> <span class="s2">"</span><span class="k">${</span><span class="nv">Bashmatic__Init</span><span class="k">}</span><span class="s2">"</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then </span><span class="nb">source</span> <span class="s2">"</span><span class="k">${</span><span class="nv">Bashmatic__Init</span><span class="k">}</span><span class="s2">"</span><span class="p">;</span> <span class="k">else </span><span class="nb">source</span> <span class="k">${</span><span class="nv">BASHMATIC_HOME</span><span class="k">}</span>/init.sh<span class="p">;</span> <span class="k">fi
</span>bashmatic.validate-subshell <span class="o">||</span> <span class="k">return </span>1</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you&#8217;rather require a library to be sourced in, but not run, use the code as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash"><span class="c">#!/usr/bin/env bash</span>
<span class="c"># load library</span>
<span class="k">if</span> <span class="o">[[</span> <span class="nt">-f</span> <span class="s2">"</span><span class="k">${</span><span class="nv">Bashmatic__Init</span><span class="k">}</span><span class="s2">"</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then </span><span class="nb">source</span> <span class="s2">"</span><span class="k">${</span><span class="nv">Bashmatic__Init</span><span class="k">}</span><span class="s2">"</span><span class="p">;</span> <span class="k">else </span><span class="nb">source</span> <span class="k">${</span><span class="nv">BASHMATIC_HOME</span><span class="k">}</span>/init.sh<span class="p">;</span> <span class="k">fi
</span>bashmatic.validate-sourced-in <span class="o">||</span> <span class="nb">exit </span>1</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_how_can_i_change_the_underscan_or_overscan_for_an_old_monitor">11.3. How can I change the underscan or overscan for an old monitor?</h3>
<div class="paragraph">
<p>If you are stuck working on a monitor that does not support switching digit input from TV to PC, NOR does OS-X show the "underscan" slider in the Display Preferences, you may be forced to change the underscan manually. The process is a bit tricky, but we have a helpful script to do that:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash"><span class="nv">$ </span><span class="nb">source </span>init.sh
<span class="nv">$ </span>change-underscan 5</code></pre>
</div>
</div>
<div class="paragraph">
<p>This will reduce underscan by 5% compared to the current value. The total value is 10000, and is stored in the file <code>/var/db/.com.apple.iokit.graphics</code>. The tricky part is determining which of the display entries map to your problem monitor. This is what the script helps with.</p>
</div>
<div class="paragraph">
<p>Do not forget to restart after the change.</p>
</div>
<div class="paragraph">
<p>Acknowledgements: the script is an automation of the method offered on <a href="http://ishan.co/external-monitor-underscan">this blog post</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_contributing">12. Contributing</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Please <a href="https://github.com/kigster/bashmatic/pulls/new"> submit a pull request</a> or at least an issue!</p>
</div>
<div class="sect2">
<h3 id="_running_unit_tests">12.1. Running Unit Tests</h3>
<div class="paragraph">
<p>The framework comes with a bunch of automated unit tests based on the fantastic framework <a href="https://github.com/sstephenson/bats.git"><code>bats</code></a>.</p>
</div>
<div class="paragraph">
<p>Bats is auto-installed by the <code>bin/specs</code> script.</p>
</div>
<div class="sect3">
<h4 id="_run_tests_using_the_provided_binspecs_script">12.1.1. Run Tests Using the Provided <code>bin/specs</code> script</h4>
<div class="paragraph">
<p>We use Bats framework for testing, however we provided a convenient wrapper <code>bin/specs</code> which installs Bats and its dependencies so that we don&#8217;t have to worry about installing it manually.</p>
</div>
<div class="paragraph">
<p>The script can be run:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Without any arguments to run all tests in the <code>test</code> folder in parallel by default</p>
</li>
<li>
<p>You can pass one or more existing test file paths as arguments, eg <code>bin/specs test/time_test.bats</code></p>
</li>
<li>
<p>Finally, you can pass an abbreviated test file name — eg "time" will resolve to <code>test/time_test.bats</code></p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The script accepts a bunch of CLI arguments and flags shown below:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="doc/img/specs-parallel.png" alt="example" width="100%">
</div>
</div>
</div>
<div class="sect3">
<h4 id="_running_specs_sequentially_with_binspec_p">12.1.2. Running Specs Sequentially with <code>bin/spec -P</code></h4>
<div class="paragraph">
<p>By the default, <code>bin/spec</code> runs tests in parallel, and takes about 20 seconds.</p>
</div>
<div class="paragraph">
<p>If you pass the <code>-P/--no-parallel</code> flag, it will run sequentially and take about twice as long.</p>
</div>
<div class="paragraph">
<p>Below is the screenshot of the tests running in the parallel mode. The script automatically detects that my machine has 16 CPU cores and uses this as a parallization factor.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="doc/img/specs.png" alt="example" width="100%">
</div>
</div>
</div>
<div class="sect3">
<h4 id="_run_tests_parallel_using_the_makefile">12.1.3. Run Tests Parallel using the <code>Makefile</code></h4>
<div class="paragraph">
<p>Note that you can run all tests in parallel using the following make target:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash">make <span class="nb">test</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>While not every single function is tested (far from it), we do try to add tests to the critical ones.</p>
</div>
<div class="paragraph">
<p>Please see <a href="https://github.com/kigster/bashmatic/blob/main/test/array_test.bats">existing tests</a> for the examples.</p>
</div>
</div>
<div class="sect3">
<h4 id="_run_tests_sequentially_using_the_makefile">12.1.4. Run Tests Sequentially using the <code>Makefile</code></h4>
<div class="paragraph">
<p>Alternatively, you can run the entire test suite via the Makefile, using one of two targets:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash">make test-sequential</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_copyright_license">13. Copyright &amp; License</h2>
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
© 2016-2022 Konstantin Gredeskoul<br>
This project is distributed under the <strong>MIT License.</strong>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2025-05-10 12:39:46 -0700
</div>
</div>
</body>
</html>
